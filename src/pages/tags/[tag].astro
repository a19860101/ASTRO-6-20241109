---
import BaseLayout from "../../layouts/BaseLayout.astro";
import PostCard from "../../components/PostCard.astro";
export async function getStaticPaths(){
    //取出所有文章
    const allPosts = await Astro.glob('../blog/posts/*.md')
    // 取出所有標籤，並且去除巢狀與移除重複
    const uniqueTags = [...new Set(allPosts.map(post=>post.frontmatter.tags).flat())]
    // return [
    //     {params: {tag: '棒球'}},
    //     {params: {tag: 'premiere 12'}},
    //     {params: {tag: '蔡其昌'}},
    //     {params: {tag: '東京巨蛋'}},
    // ]
    
    
    return uniqueTags.map(tag=>{
        // 篩選有該標籤的文章
        const filterPosts = allPosts.filter(post=>post.frontmatter.tags.includes(tag))
        return {
            params: {tag},
            props: {posts: filterPosts}
        }
    })
}
const {tag} = Astro.params
const {posts} = Astro.props

// const filterPosts = allPosts.filter(post=>post.frontmatter.tags.includes(tag))
---
<BaseLayout title={tag}>
    <div class="breadcrumb">
        標籤為 <b>{tag}</b> 的文章
    </div>
    <div class="container">
        {posts.map(post=><PostCard url={post.url} data={post.frontmatter}></PostCard>)}
    </div>
</BaseLayout>
<style>
    .container {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        grid-auto-rows: 250px;
        gap: 15px;
        margin-bottom: 30px;
    }
</style>